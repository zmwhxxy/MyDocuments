{"id":"01jdec6x1vrc47tpe518xqxmvd","add_time_ms":1732428133435,"type":"doc","title":"5.设置环境变量","_id":"180","char_count":{"word":331,"char_without_spaces":1387,"char_with_spaces":1743,"char_all":1817},"content":"### 设置环境变量\n\n#### 编写test_env.lua文件\n\n在skynet中，使用skynet.setenv函数来设置一个新的环境变量（必须是新的，原来环境没有的变量）；skynet.getenv函数来获取环境变量的值。实例代码如下\n\n    local skynet = require(\"skynet\")\n\n    skynet.start(function()\n        -- 设置新的环境变量myname的值为xxx\n        skynet.setenv(\"myname\", \"xxx\") -- 如果环境中有myname变量，会报错\n    \n        -- 获取环境变量的值\n       local name = skynet.getenv(\"myname\")\n        local age = skynet.getenv(\"myage\")\n\n        skynet.error(\"My name is\", name, \"and I'm\", age, \"'s old\")\n    end)\n\n\n#### 编写test_env_cf文件\n\n    -- 路径设置\n    root = \"./\"\n    luaservice = root..\"service/?.lua;\" .. root .. \"project/?.lua\"\n    lualoader = root .. \"lualib/loader.lua\"\n    lua_path = root..\"lualib/?.lua;\"..root..\"lualib/?/init.lua\"\n    lua_cpath = root .. \"luaclib/?.so\"\n\n    -- 设置环境变量\n    myname = \"eli\"\n    myage = 30\n\n    -- 参数配置\n    thread = 8\n    logger = nil\n    logpath = \".\"\n    harbor = 1\n    address = \"127.0.0.1:2526\"\n    master = \"127.0.0.1:2024\"\n\n    -- 启动test服务\n    start = \"test_env\"\n    bootstrap = \"snlua bootstrap\"\n    standalone = \"0.0.0.0:2024\"\n    cpath = root..\"cservice/?.so\"\n\n#### 执行test_env服务\n\n在linux终端中执行以下命令：\n        ./skynet test_env_cf\n \n 执行成功后终端打印如下内容：\n \n    [:01000002] LAUNCH snlua bootstrap\n    [:01000003] LAUNCH snlua launcher\n    [:01000004] LAUNCH snlua cmaster\n    [:01000004] master listen socket 0.0.0.0:2024\n    [:01000005] LAUNCH snlua cslave\n    [:01000005] slave connect to master 127.0.0.1:2024\n    [:01000004] connect from 127.0.0.1:48132 4\n    [:01000006] LAUNCH harbor 1 16777221\n    [:01000004] Harbor 1 (fd=4) report 127.0.0.1:2526\n    [:01000005] Waiting for 0 harbors\n    [:01000005] Shakehand ready\n    [:01000007] LAUNCH snlua datacenterd\n    [:01000008] LAUNCH snlua service_mgr\n    [:01000009] LAUNCH snlua test_env\n    [:01000009] My name is eli and I'm 30 's old\n    [:01000002] KILL self\n\n\n\n\n","edit_time_ms":1732503553055,"snapshots":[{"id":"01jdecj7hbdq2mbnh7qg8d9vt6","item_id":"01jdec6x1vrc47tpe518xqxmvd","add_time_ms":1732428504619,"hash":"cc46bde75e67949bbc4495fa3592096b","length":12,"char_count_char_with_spaces":10,"char_count_char_without_spaces":9,"char_count_word":7,"version_key":1},{"id":"01jdee96q4thx77z9cnx5dk1vb","item_id":"01jdec6x1vrc47tpe518xqxmvd","add_time_ms":1732430306020,"hash":"b5d93d9141a4173e4cecca4d3e61e519","length":1504,"char_count_char_with_spaces":1436,"char_count_char_without_spaces":1220,"char_count_word":235,"version_key":1},{"id":"01jdgkvgvfs2cxq7yh0m5j8ch4","item_id":"01jdec6x1vrc47tpe518xqxmvd","add_time_ms":1732503257967,"hash":"27ec9e5d61c78fd3719a7edd15273dab","length":1556,"char_count_char_with_spaces":1487,"char_count_char_without_spaces":1271,"char_count_word":264,"version_key":1}]}