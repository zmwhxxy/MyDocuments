{"id":"01j0qhcbswy7fd3e4pmwthc5rz","add_time_ms":1718776901436,"type":"doc","title":"我是国王","_id":"73","char_count":{"word":140,"char_without_spaces":618,"char_with_spaces":1130,"char_all":1166},"content":"状态转换函数\n      updateState() {\n        let x = this.joystick.dir.x;\n        let y = this.joystick.dir.y;\n\n        if (x === 0 && y === 0) {\n            if (this.isAttackStart) {\n                this.attackDown();\n            } else {\n                this.idle();\n            }\n        } else if (-Math.PI / 4 < Math.atan2(y, x) && Math.atan2(y, x) <= Math.PI / 4) {  //向右\n            if (this.isAttackStart) {\n                this.attackRight();\n            } else {\n                this.moveRight();\n            }\n        } else if (Math.PI / 4 < Math.atan2(y, x) && Math.atan2(y, x) <= Math.PI * 3 / 4) { // 向上\n            if (this.isAttackStart) {\n                this.attackUp();\n            } else {\n                this.moveUp();\n            }\n        } else if (-Math.PI * 3 / 4 < Math.atan2(y, x) && Math.atan2(y, x) <= -Math.PI / 4) { // 向下\n            if (this.isAttackStart) {\n                this.attackDown()\n            } else {\n                this.moveDown();\n            }\n        } else {  // 向左\n            if (this.isAttackStart) {\n                this.attackLeft();\n            } else {\n                this.moveLeft();\n            }\n        }\n    }","edit_time_ms":1718776922534}